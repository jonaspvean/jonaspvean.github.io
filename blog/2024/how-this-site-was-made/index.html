<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> How This Site Came to Be | Jonas Pedersen Vean </title> <meta name="author" content="Jonas Pedersen Vean"> <meta name="description" content="Or how I learned a bit of Docker, Linux, Git and TypeScript through sheer willpower"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/faviconmathscrPnew.png?0d6128554121adeea0c7cfd4ced12b08"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="stylesheet" href="/assets/css/custom.css"> <link rel="canonical" href="https://jonaspvean.github.io/blog/2024/how-this-site-was-made/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jonas</span> Pedersen Vean </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/public/">research notes </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">How This Site Came to Be</h1> <p class="post-meta"> Created in August 13, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/frontend"> <i class="fa-solid fa-hashtag fa-sm"></i> frontend</a>   <a href="/blog/tag/blog-meta"> <i class="fa-solid fa-hashtag fa-sm"></i> blog-meta</a>     ·   <a href="/blog/category/programming"> <i class="fa-solid fa-tag fa-sm"></i> programming</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="a-soft-start">A Soft Start</h2> <p>At the beginning of this year I started this project just like any other innocent little sidetrack (read: procrastination) from my other, more pressing obligations. My intention was to throw together a website that could help illustrate what I had been working on in 2023. Having been inspired by the GitHub-pages sites of <a href="https://folk.ntnu.no/torgeaam/" rel="external nofollow noopener" target="_blank">Torgeir Aambø</a> and <a href="https://szymik.github.io/" rel="external nofollow noopener" target="_blank">Markus Szymik</a> I decided I wanted to make a site using the GitHub-page style deployment as well. I found the <a href="https://alshedivat.github.io/al-folio/" rel="external nofollow noopener" target="_blank">al-folio theme</a> which I found favourable as a starting point for further development. Things seemed to be on-track for a finished website in no time!</p> <p>Meanwhile, I had been working on studying through Peter J. Olver’s book <em><a href="https://link.springer.com/book/10.1007/978-1-4612-4350-2" rel="external nofollow noopener" target="_blank">Applications of Lie Groups to Differential Equations</a></em> and sought after software that I could use for writing notes on the various definitions found in the book. It was then that Obsidian, a software that can take markdown files and transpile them into rendered pages, was brought into my attention. Suddenly, I found the idea of sharing my notes on the same site as the GitHub-pages content to be increasingly captivating. A small hiccup however – Obsidian does not allow for gh-pages publishing unless you pay for the premium version! I wasn’t having it, but quickly learned of an open-source alternative for static site rendering of markdown files. Enter <a href="https://quartz.jzhao.xyz/" rel="external nofollow noopener" target="_blank">Quartz 4.0</a>. In Quartz there is a simple way to sync the notes with a GitHub repository, which means that one could also use the GitHub-pages deployment to easily make a website displaying the Quartz notes. Now all that remained was to combine the Jekyll-deployed al-folio website with the Quartz notes site. As it turns out, this was a lot easier said than done.</p> <p><br></p> <h2 id="quarrelling-with-docker">Quarrelling with Docker</h2> <p>First, I need to explain how GitHub pages work. Essentially, the standard is to have a master branch (alternatively: a production branch along with a deployment branch for the sake of best practice) and a <em>gh-pages</em> branch that is automatically deployed from the master branch by GitHub actions. I needed some way of seeing what the website would look like before actually deploying it, so the Docker container option for hot-reloading and local deployment seemed like a fair choice. At this point I was using Visual Studio Code in Windows 10, and ran into no issues doing everything in Windows. However, as the al-folio documentation suggests, you need to use the <a href="https://docs.docker.com/compose/install/" rel="external nofollow noopener" target="_blank">Docker Compose</a> plugin in order to compose the container that allows for local deployment. If you go to the installation page, you are greeted with this lovely message:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/docker_compose_screenshot-480.webp 480w,/assets/img/docker_compose_screenshot-800.webp 800w,/assets/img/docker_compose_screenshot-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/docker_compose_screenshot.png" class="img-fluid rounded z-depth-1 small-centered" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> "This is only available on Linux". </div> <p>After some more research, I found out that you could use a virtual environment called <em><a href="https://learn.microsoft.com/en-us/windows/wsl/install" rel="external nofollow noopener" target="_blank">Windows Subsystem for Linux</a></em> (shortened as WSL) to run Linux on Windows. Installing WSL was quite easy, but installing Docker Compose on WSL happened became quite a challenge. Having never used Linux before, I could not quite grasp why running <code class="language-plaintext highlighter-rouge">sudo apt-get docker compose</code> did not install the plugin successfully. Throughout this period I must have reinstalled Docker and Docker Compose a dozen times, until I finally got both Docker and Docker Compose working in the WSL Ubuntu terminal after about three or four weeks of wrangling with the installations. Anyway, after all this trouble I could finally deploy the website locally using the command <code class="language-plaintext highlighter-rouge">docker compose up</code>. Looking ahead, the only practical thing Docker Compose did was introducing me to Linux, as I abandoned using the Docker containers for the much simpler <code class="language-plaintext highlighter-rouge">bundle exec jekyll serve</code> command, which yields a locally hosted site that can be updated on saved changes.</p> <p><br></p> <h2 id="jekyll-and-hide-better-still--run">Jekyll (and Hide, Better Still – Run!)</h2> <p>The al-folio site is built by way of <a href="https://jekyllrb.com/" rel="external nofollow noopener" target="_blank">Jekyll</a>. Having read through some of the Jekyll documentation I gathered that the folder of interest for deployment into gh-pages was the <code class="language-plaintext highlighter-rouge">_site/</code> folder found in the root directory after having built the site with <code class="language-plaintext highlighter-rouge">bundle exec jekyll build</code> in the terminal. Naturally, I thought that I could simply just add the entire Quartz repository into <code class="language-plaintext highlighter-rouge">_site/</code> and be done with it! After all, if I built and deployed the site locally this approach actually worked! The issue was that the Quartz notes were not being pushed into the GitHub master branch, it was if the files were disappearing after <code class="language-plaintext highlighter-rouge">git push</code> was used! At the time I was quite ignorant as to how Jekyll and GitHub Actions worked, so I had no idea that</p> <ol> <li>the <code class="language-plaintext highlighter-rouge">_site/</code> folder was included in the <code class="language-plaintext highlighter-rouge">.gitignore</code> file, so the local version wasn’t being pushed,</li> <li>removing the <code class="language-plaintext highlighter-rouge">_site/</code> from <code class="language-plaintext highlighter-rouge">.gitignore</code> would result in each commit updating over 16 000 files,</li> <li>the reason each commit updated over 16 000 files was due to Jekyll re-building the files that were being pushed from the local directories into the master branch due to the GitHub Actions workflow,</li> <li>and, finally, this would become a lot more complicated than I anticipated.</li> </ol> <p>Turns out that GitHub pages <a href="https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll/about-github-pages-and-jekyll" rel="external nofollow noopener" target="_blank">cannot build with unsupported plugins</a>, and that Quartz notes was not built using Jekyll the way the al-folio site was. I had assumed that since Quartz transforms markdown files into static sites that it relied on Jekyll, since Jekyll is roughly speaking doing the same thing. In actual fact, Quartz’ way of transforming markdown files is quite clever, and in my opinion ends up being more clever than the way Jekyll works in practice (example: in certain situations Jekyll might try parsing <code class="language-plaintext highlighter-rouge">README.md</code> files!)</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/quartz-transform-pipeline-480.webp 480w,/assets/img/quartz-transform-pipeline-800.webp 800w,/assets/img/quartz-transform-pipeline-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/quartz-transform-pipeline.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Pipeline sketch of how Quartz 4.0 transforms files. From the <a href="https://quartz.jzhao.xyz/advanced/making-plugins" rel="external nofollow noopener" target="_blank"> Quartz docs</a>. </div> <p>So, the al-folio site builds using Jekyll and includes-files written in liquid, and Quartz builds using an architecture written in TypeScript. Not only is this remark important for understanding why my combined website was not being deployed correctly, but it also points to a problem I would deal with a few months from this point, which was implementing the al-folio NavBar (the bar with links at the top of the site) to the Quartz section of the site. The way Quartz builds its site means that you cannot simply inject html code to the various <code class="language-plaintext highlighter-rouge">index.html</code> defining the subpages of Quartz. In practice what you have to do instead is to write and stylize a Quartz component in TypeScript, which in this instance would be <code class="language-plaintext highlighter-rouge">NavBar.tsx</code>. More on this later.</p> <p><br></p> <h2 id="git-and-the-headaches-committed">Git and the Headaches Committed</h2> <p>It had been my intention to properly learn commandline git anyway, but I had imagined it would be less painful. You see, when working with GitHub pages, you are essentially working with four different branches off the get-go: the master branches both locally (HEAD) and remotely (origin master), and similarly for the deployed gh-pages branches. In normal circumstances you could forego working locally in the gh-pages branch since everything would deploy as-is to the remote repository. We are not so lucky. As the GitHub pages docs rightfully says, if you want to deploy plugin-like features to gh-pages you need to push the static files to gh-pages from the local repo.</p> <p>Here is another caveat: I wanted the notes from Quartz to be synced with the website from its own repository. The most naïve way of doing this is to include the Quartz notes repo as a git submodule, which is the solution I settled for. This in turn meant that there were, in effect, six different branches to account for when managing the git workflows altogether, since the notes folder inside the root directory of the combined al-folio + Quartz site then also had a local version and remote version, where the remote branch is now seperate from its origin main branch! What this meant is that I suddenly had to think about <a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell" rel="external nofollow noopener" target="_blank">commits as pointers to snapshots</a>, where for instance the HEAD pointer could suddenly be <em>detached</em> from any relevant working branch.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/git-branches-schematic.webp-480.webp 480w,/assets/img/git-branches-schematic.webp-800.webp 800w,/assets/img/git-branches-schematic.webp-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/git-branches-schematic.webp" class="img-fluid rounded z-depth-1 small-centered" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Here, the index/staging area includes the HEAD pointer as mentioned above. Credit to <a href="https://www.reddit.com/r/git/comments/99ul9f/git_workflow_diagram_showcasing_the_role_of/" rel="external nofollow noopener" target="_blank"> u/stamminator from r/git</a>. </div> <p>These kinds of headaches would be plentiful and recurring whilst working on various stages of the project, simply because mixing manual deployment of static files and automatic deployment of files from the production branch eventually lead to merge conflicts, HEAD suddenly detaching and needing to be upstreamed to origin master/main, untracked files that mysteriously exist because of notes git submodule, and so on. I suppose in hindsight these were all good exercises in what to do when faced with cumbersome issues in git, but in the moment they felt a bit overwhelming.</p> <p>I spent a good two months wrestling with git whilst trying to understand how to add Quartz notes to the combined site, and I finally got something working back in the middle of May. Unsurprisingly, I had to stop Jekyll from trying to convert <em>every</em> markdown file it could find, so I first tried to include a <code class="language-plaintext highlighter-rouge">.nojekyll</code> file in the notes directory of the master folder. This did not work, as the problem persisted when GitHub Actions automatically pushed from the production branch to the deployment branch.</p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Jonas Pedersen Vean. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with a modified <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>